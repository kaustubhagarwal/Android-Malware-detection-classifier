Reading data from CSV file...
Found (5560) malwares in csv file.
Found (129013) files to classify.
Found (5560) malware files.
Found (123453) safe files.

Features & Labels arrays' shapes, respectively: (11118, 8) (11118,)

Features Selection based on KBest:

scores for each attribute and the 4 attributes chosen:
[  855.957 19501.321   226.068  1721.599  2203.355  2370.475  2537.355
   608.951]
[[11  7  6 11]
 [11  6  5  6]
 [ 4  2  2  2]
 [ 1  1  1  2]
 [21  1  1  1]]

Features Selection based on Recursive Features Elimination:

RFE chose the the top 4 features:
Numbers Features: 4
Selected Features: [ True  True False False  True  True False False]
Feature Ranking: [1 1 3 4 1 1 2 5]

Features Selection based on Extra trees classifier:

Feature ranking (ordered DESC) using extra trees classifier:
1. feature 1 (0.272489)
2. feature 7 (0.130598)
3. feature 6 (0.117242)
4. feature 0 (0.113289)
5. feature 2 (0.106836)
6. feature 3 (0.106155)
7. feature 4 (0.077137)
8. feature 5 (0.076255)

Features Selection based on Random Forest classifier:

Feature ranking (ordered DESC) using random forest classifier:
1. feature 1 (0.271567)
2. feature 7 (0.147943)
3. feature 2 (0.124353)
4. feature 3 (0.114921)
5. feature 0 (0.106847)
6. feature 6 (0.106012)
7. feature 4 (0.067016)
8. feature 5 (0.061342)

Training data shape (x, y): (8894, 8) (8894,)

Testing data shape (x, y): (2224, 8) (2224,)

-------------SVM Model-------------
SVM Evaluation parameters:
Accuracy is 85.971223 (in percentage)
Confusion Matrix:
[[972 130]
 [182 940]]
Recall score is 0.837790.
Precision score is 0.878505.
F1 score is 0.857664.
classification Report:
              precision    recall  f1-score   support

           0       0.84      0.88      0.86      1102
           1       0.88      0.84      0.86      1122

    accuracy                           0.86      2224
   macro avg       0.86      0.86      0.86      2224
weighted avg       0.86      0.86      0.86      2224

-----------------------------------

AUC Score: 0.8599111645978306
-------------SVM, C value Model-------------
C value: 10
SVM, tuned C val Evaluation parameters:
Accuracy is 86.780576 (in percentage)
Confusion Matrix:
[[974 128]
 [166 956]]
Recall score is 0.852050.
Precision score is 0.881919.
F1 score is 0.866727.
classification Report:
              precision    recall  f1-score   support

           0       0.85      0.88      0.87      1102
           1       0.88      0.85      0.87      1122

    accuracy                           0.87      2224
   macro avg       0.87      0.87      0.87      2224
weighted avg       0.87      0.87      0.87      2224

-----------------------------------

AUC Score: 0.8679487303913481
-------------SVM, C value Model-------------
C value: 100
SVM, tuned C val Evaluation parameters:
Accuracy is 87.679856 (in percentage)
Confusion Matrix:
[[984 118]
 [156 966]]
Recall score is 0.860963.
Precision score is 0.891144.
F1 score is 0.875793.
classification Report: 
              precision    recall  f1-score   support

           0       0.86      0.89      0.88      1102
           1       0.89      0.86      0.88      1122

    accuracy                           0.88      2224
   macro avg       0.88      0.88      0.88      2224
weighted avg       0.88      0.88      0.88      2224

-----------------------------------

AUC Score: 0.8769422634587575
-------------SVM, C value Model-------------
C value: 1000
SVM, tuned C val Evaluation parameters:
Accuracy is 88.084532 (in percentage)
Confusion Matrix:
[[989 113]
 [152 970]]
Recall score is 0.864528.
Precision score is 0.895660.
F1 score is 0.879819.
classification Report: 
              precision    recall  f1-score   support

           0       0.87      0.90      0.88      1102
           1       0.90      0.86      0.88      1122

    accuracy                           0.88      2224
   macro avg       0.88      0.88      0.88      2224
weighted avg       0.88      0.88      0.88      2224

-----------------------------------

AUC Score: 0.8809933971938883
-------------RF Model-------------
RF Evaluation parameters:
Accuracy is 94.334532 (in percentage)
Confusion Matrix:
[[1035   67]
 [  59 1063]]
Recall score is 0.947415.
Precision score is 0.940708.
F1 score is 0.944050.
classification Report:
              precision    recall  f1-score   support

           0       0.95      0.94      0.94      1102
           1       0.94      0.95      0.94      1122

    accuracy                           0.94      2224
   macro avg       0.94      0.94      0.94      2224
weighted avg       0.94      0.94      0.94      2224

-----------------------------------

AUC Score: 0.9433083908369484
8.48 Time to finish with default nJobs

-------------RF Model with nJobs-------------
N_Jobs: 10
RF Evaluation parameters:
Accuracy is 94.424460 (in percentage)
Confusion Matrix:
[[1030   72]
 [  52 1070]]
Recall score is 0.953654.
Precision score is 0.936953.
F1 score is 0.945230.
classification Report: 
              precision    recall  f1-score   support

           0       0.95      0.93      0.94      1102
           1       0.94      0.95      0.95      1122

    accuracy                           0.94      2224
   macro avg       0.94      0.94      0.94      2224
weighted avg       0.94      0.94      0.94      2224

-----------------------------------

AUC Score: 0.9441592178861316
9.96 Time to finish with 10 nJobs

-------------RF Model with nJobs-------------
N_Jobs: 10
N_Estimators: 1000
RF Evaluation parameters:
Accuracy is 94.379496 (in percentage)
Confusion Matrix:
[[1032   70]
 [  55 1067]]
Recall score is 0.950980.
Precision score is 0.938434.
F1 score is 0.944666.
classification Report:
              precision    recall  f1-score   support

           0       0.95      0.94      0.94      1102
           1       0.94      0.95      0.94      1122

    accuracy                           0.94      2224
   macro avg       0.94      0.94      0.94      2224
weighted avg       0.94      0.94      0.94      2224

-----------------------------------

AUC Score: 0.9437297605067435
15.68 Time to finish with 10 nJobs and 1000 nEstimators

-------------Extra Trees Model-------------
ET Evaluation parameters:
Accuracy is 94.739209 (in percentage)
Confusion Matrix:
[[1044   58]
 [  59 1063]]
Recall score is 0.947415.
Precision score is 0.948260.
F1 score is 0.947838.
classification Report: 
              precision    recall  f1-score   support

           0       0.95      0.95      0.95      1102
           1       0.95      0.95      0.95      1122

    accuracy                           0.95      2224
   macro avg       0.95      0.95      0.95      2224
weighted avg       0.95      0.95      0.95      2224

-----------------------------------

AUC Score: 0.9473918754104513
70.86 Time to finish ET with 100 nEstimators

-------------Extra Trees Model-------------
Number of estimators: 500
ET Evaluation parameters:
Accuracy is 94.874101 (in percentage)
Confusion Matrix:
[[1044   58]
 [  56 1066]]
Recall score is 0.950089.
Precision score is 0.948399.
F1 score is 0.949243.
classification Report: 
              precision    recall  f1-score   support

           0       0.95      0.95      0.95      1102
           1       0.95      0.95      0.95      1122

    accuracy                           0.95      2224
   macro avg       0.95      0.95      0.95      2224
weighted avg       0.95      0.95      0.95      2224

-----------------------------------

AUC Score: 0.9487287738061733
19.94 Time to finish ET with 500 nEstimators

-------------Extra Trees Model-------------
Number of estimators: 1000
ET Evaluation parameters:
Accuracy is 94.784173 (in percentage)
Confusion Matrix:
[[1042   60]
 [  56 1066]]
Recall score is 0.950089.
Precision score is 0.946714.
F1 score is 0.948399.
classification Report:
              precision    recall  f1-score   support

           0       0.95      0.95      0.95      1102
           1       0.95      0.95      0.95      1122

    accuracy                           0.95      2224
   macro avg       0.95      0.95      0.95      2224
weighted avg       0.95      0.95      0.95      2224

-----------------------------------

AUC Score: 0.9478213327898394
14.52 Time to finish ET with 1000 nEstimators

-------------Extra Trees Model-------------
ET Evaluation parameters:
Accuracy is 95.053957 (in percentage)
Confusion Matrix:
[[1044   58]
 [  52 1070]]
Recall score is 0.953654.
Precision score is 0.948582.
F1 score is 0.951111.
classification Report: 
              precision    recall  f1-score   support

           0       0.95      0.95      0.95      1102
           1       0.95      0.95      0.95      1122

    accuracy                           0.95      2224
   macro avg       0.95      0.95      0.95      2224
weighted avg       0.95      0.95      0.95      2224

-----------------------------------

AUC Score: 0.9505113050004692
10.87 Time to finish ET with 100 nJobs

-------------Extra Trees Model-------------
ET Evaluation parameters:
Accuracy is 94.559353 (in percentage)
Confusion Matrix:
[[1039   63]
 [  58 1064]]
Recall score is 0.948307.
Precision score is 0.944099.
F1 score is 0.946198.
classification Report:
              precision    recall  f1-score   support

           0       0.95      0.94      0.94      1102
           1       0.94      0.95      0.95      1122

    accuracy                           0.95      2224
   macro avg       0.95      0.95      0.95      2224
weighted avg       0.95      0.95      0.95      2224

-----------------------------------

AUC Score: 0.9455689056681903
8.48 Time to finish ET with 500 nJobs

-------------Extra Trees Model-------------
ET Evaluation parameters:
Accuracy is 94.514388 (in percentage)
Confusion Matrix:
[[1043   59]
 [  63 1059]]
Recall score is 0.943850.
Precision score is 0.947227.
F1 score is 0.945536.
classification Report:
              precision    recall  f1-score   support

           0       0.94      0.95      0.94      1102
           1       0.95      0.94      0.95      1122

    accuracy                           0.95      2224
   macro avg       0.95      0.95      0.95      2224
weighted avg       0.95      0.95      0.95      2224

-----------------------------------

AUC Score: 0.9451556237079884
8.3 Time to finish ET with 1000 nJobs

-------------RFE Model-------------
C:\Users\Kaustubh Agarwal\Anaconda3\lib\site-packages\sklearn\utils\validation.py:70: FutureWarning: Pass n_features_to_select=4 as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f"Pass {args_msg} as keyword args. From version "
Accuracy is 77.113309 (in percentage)
Confusion Matrix: 
[[929 173]
 [336 786]]
Recall score is 0.700535.
Precision score is 0.819604.
F1 score is 0.755406.
classification Report: 
              precision    recall  f1-score   support

           0       0.73      0.84      0.78      1102
           1       0.82      0.70      0.76      1122

    accuracy                           0.77      2224
   macro avg       0.78      0.77      0.77      2224
weighted avg       0.78      0.77      0.77      2224

-----------------------------------

AUC Score: 0.7717737317662587
-------------NB Model-------------
NB Evaluation parameters:
Accuracy is 54.946043 (in percentage)
Confusion Matrix:
[[ 174  928]
 [  74 1048]]
Recall score is 0.934046.
Precision score is 0.530364.
F1 score is 0.676566.
classification Report: 
              precision    recall  f1-score   support

           0       0.70      0.16      0.26      1102
           1       0.53      0.93      0.68      1122

    accuracy                           0.55      2224
   macro avg       0.62      0.55      0.47      2224
weighted avg       0.62      0.55      0.47      2224

-----------------------------------
